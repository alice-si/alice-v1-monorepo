<div ng-controller="DashboardDonationsController as donCtrl">
  <div class="donations">
    <div class="row" style="margin-top: 55px;">
      <div class="col-md-3 col-sm-6 col-xs-6">
        <div class="donations-total-header">
          <span class="circle" style="background-color: #1998a2;"></span>Total raised
          <div class="donations-total-value">
            {{donCtrl.donated | money}}
          </div>
        </div>
      </div>

      <div class="col-md-3 col-sm-6 col-xs-6">
        <div class="donations-total-header">
          <span class="circle" style="background-color: #B7B7B7;"></span>Total received
          <div class="donations-total-value">
            {{donCtrl.received | money}}
          </div>
        </div>
      </div>
    </div>

    <div class="flot-chart" ng-if="donCtrl.donationsChartData[0].data.length > 0 || donCtrl.donationsChartData[1].data.length > 0">
      <div id="flot-tooltip"></div>
      <div class="flot-chart-content">
        <flot id="flot-chart" dataset="donCtrl.donationsChartData" options="donCtrl.donationsChartOptions" height="300px"></flot>
      </div>
      <div class="y-label">Donations('000)</div>
    </div>

    <div>
      <div class="impact-table-header" style="min-height:40px;">
        <span class="col-md-4">Donations table</span>
        <a id="exportDonationsButton"
           class="btn btn-primary btn-export"
           ng-click="donCtrl.exportToExcel()">Export data</a>
        <input class="table-search" ng-model="donCtrl.donationSearch" placeholder="Search">
        <div class="col-md-3 project-title-in-bar" ng-repeat="project in donCtrl.projectsWithDonations">
          <!-- {{project.title}} -->
          <!-- <input type="checkbox" icheck ng-model="project.selected"> -->
          <!-- Hide the project name and export all Donations -->
          <input id="donation-check" type="checkbox" ng-model="project.selected">
        </div>
      </div>

      <div class="row">
        <div class="col-sm-3 col-xs-6" style="text-align: center;">
          <div class="impact-summary">
            <div>Total donated</div>
            <div class="impact-summary-value">{{donCtrl.donated | money}}</div>
          </div>
        </div>
        <div class="col-sm-3 col-xs-6" style="text-align: center;">
          <div class="impact-summary">
            <div>Total received</div>
            <div class="impact-summary-value">{{donCtrl.received | money}}</div>
          </div>
        </div>
        <div class="col-sm-3 col-xs-6" style="text-align: center;">
          <div class="impact-summary" style="text-align: center;">
            <div>Total donors</div>
            <div class="impact-summary-value">{{donCtrl.donations.length | number}}</div>
          </div>
        </div>
        <div class="col-sm-3 col-xs-6" style="text-align: center;">
          <div class="impact-summary" style="text-align: center;">
            <div>Average donation</div>
            <div class="impact-summary-value">{{donCtrl.avgDonation | money}}</div>
          </div>
        </div>
      </div>



      <table id="donations" class="impact-table">
        <tr>
          <!-- <td>#
            <sort action="donCtrl.sort" field="pos"></sort>
          </td> -->
          <td>Name
            <sort action="donCtrl.sort" field="fullName"></sort>
          </td>
          <td>Email
            <sort action="donCtrl.sort" field="email"></sort>
          </td>
          <td>Raised
            <sort action="donCtrl.sort" field="total"></sort>
          </td>
          <td>Donations
            <sort action="donCtrl.sort" field="count"></sort>
          </td>
          <td>Latest
            <sort action="donCtrl.sort" field="last"></sort>
          </td>
          <!-- <td>Refunded
            <sort action="donCtrl.sort" field="refunded"></sort>
          </td> -->
          <td>Received
            <sort action="donCtrl.sort" field="paidOut"></sort>
          </td>
          <td>Gift aid
            <sort action="donCtrl.sort" field="giftAid"></sort>
          </td>
          <td>Contact
            <sort action="donCtrl.sort" field="agreeContact"></sort>
          </td>
        </tr>
        <tr ng-repeat="donation in donCtrl.donations | filter:donCtrl.donationSearch | orderBy : donCtrl.sortField">
          <!-- <td>{{donation.pos}}</td> -->
          <td>{{donation.fullName}}</td>
          <td>{{donation.email}}</td>
          <td>{{donation.total | money}}</td>
          <td>{{donation.count}}</td>
          <td>{{donation.last | date}}</td>
          <!-- <td>{{donation.refunded | money}}</td> -->
          <td>{{donation.paidOut | money}}</td>
          <td>{{donation.giftAid ? 'Yes' : 'No'}}</td>
          <td>{{donation.agreeContact ? 'Yes' : 'No'}}</td>
        </tr>
      </table>

    </div>
  </div>
</div>
